var _content=function(){"use strict";var ye=Object.defineProperty;var ne=d=>{throw TypeError(d)};var he=(d,A,b)=>A in d?ye(d,A,{enumerable:!0,configurable:!0,writable:!0,value:b}):d[A]=b;var Q=(d,A,b)=>he(d,typeof A!="symbol"?A+"":A,b),X=(d,A,b)=>A.has(d)||ne("Cannot "+b);var z=(d,A,b)=>(X(d,A,"read from private field"),b?b.call(d):A.get(d)),U=(d,A,b)=>A.has(d)?ne("Cannot add the same private member more than once"):A instanceof WeakSet?A.add(d):A.set(d,b),ae=(d,A,b,D)=>(X(d,A,"write to private field"),D?D.call(d,b):A.set(d,b),b),ee=(d,A,b)=>(X(d,A,"access private method"),b);var _,L,V,q,G,N,ie,oe;function d(n){return n}const A="#summatube-panel{margin:20px 0;border-radius:16px;overflow:hidden;box-shadow:0 8px 32px #00000026;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.1);font-family:Roboto,YouTube Sans,sans-serif;max-width:400px;transition:all .3s ease}.summatube-header{padding:18px 20px;color:#fff;display:flex;justify-content:space-between;align-items:center;box-shadow:0 4px 15px #8b00ff4d;cursor:pointer}.summatube-header.light{background:linear-gradient(135deg,#a100ff,#ff3578)}.summatube-header.dark{background:linear-gradient(135deg,#8b00ff,#ff006e)}.summatube-content{padding:20px;max-height:500px;overflow-y:auto;font-size:14.5px;line-height:1.7;transition:max-height .4s ease,padding .3s ease,opacity .3s ease}.summatube-content.light{background:#ffffffeb;color:#0f0f0f}.summatube-content.dark{background:#0f0f0fd9;color:#e0e0e0}.chunk{margin-bottom:24px;padding:16px;background:#8b00ff14;border-radius:12px;border-left:4px solid #A100FF}.timestamp{font-weight:600;color:#a100ff;cursor:pointer;margin-bottom:8px}.timestamp:hover{text-decoration:underline}.status-text{text-align:center;padding:60px 20px;color:#aaa;font-style:italic}.status-text .emoji{font-size:48px;margin-bottom:16px;opacity:.3}#summatube-toggle-btn{background:none;border:none;color:#fff;font-size:32px;cursor:pointer;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:background .2s,transform .3s}#summatube-toggle-btn:hover{background:#fff3}#summatube-panel.minimized .summatube-content{max-height:0;padding:0 20px;opacity:0;overflow:hidden}#summatube-panel::-webkit-scrollbar{width:6px}#summatube-panel::-webkit-scrollbar-track{background:transparent}#summatube-panel::-webkit-scrollbar-thumb{background:#888;border-radius:3px}#summatube-panel::-webkit-scrollbar-thumb:hover{background:#aaa}.header-title{font-size:20px;font-weight:600}.header-subtitle{font-size:13px;opacity:.9;margin-top:2px}.summary-section{margin:32px 0 0;padding-top:24px;border-top:1px solid rgba(161,0,255,.2)}.summary-btn{background:#a100ff;color:#fff;border:none;padding:12px 20px;border-radius:12px;font-weight:600;font-size:15px;cursor:pointer;box-shadow:0 4px 12px #a100ff4d;transition:all .2s}.summary-btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 16px #a100ff66}.summary-btn:disabled{opacity:.7;cursor:not-allowed}.summary-result{margin-top:20px}.summary-card{padding:20px;background:#a100ff1f;border-radius:16px;border-left:4px solid #A100FF}.summary-title{font-weight:600;font-size:16px;color:#a100ff;margin-bottom:12px}.summary-quote{font-style:italic;opacity:.8;margin-bottom:12px}.summary-footer{margin-top:16px;font-size:12px;opacity:.7;text-align:right}.summary-link{color:#a100ff;text-decoration:underline}.error-text{color:#ff6b6b;font-style:italic;padding:16px;text-align:center}.api-key-section{margin-bottom:16px;padding:16px;background:#a100ff14;border-radius:12px;border:1px solid rgba(161,0,255,.2)}.api-key-input-group{display:flex;gap:8px;margin-bottom:12px}.api-key-input{flex:1;padding:8px 12px;border:1px solid rgba(161,0,255,.3);border-radius:8px;background:#ffffffe6;color:#0f0f0f;font-size:14px}.api-key-input:focus{outline:none;border-color:#a100ff;box-shadow:0 0 0 2px #a100ff33}.dark .api-key-input{background:#1f1f1fe6;color:#e0e0e0;border-color:#a100ff66}.save-api-key-btn{background:#a100ff;color:#fff;border:none;padding:8px 16px;border-radius:8px;font-weight:600;font-size:14px;cursor:pointer;transition:all .2s}.save-api-key-btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px #a100ff4d}.api-key-help{font-size:12px;opacity:.8;text-align:center}.api-link{color:#a100ff;text-decoration:underline}.api-key-btn{background:#a100ff1a;color:#a100ff;border:1px solid rgba(161,0,255,.3);padding:6px 12px;border-radius:8px;font-size:12px;cursor:pointer;margin-left:8px;transition:all .2s}.api-key-btn:hover{background:#a100ff33}",b={matches:["*://*.youtube.com/*"],cssInjectionMode:"ui",main(){const n=document.createElement("style");n.textContent=A,document.head.appendChild(n),console.log("SummaTube loaded on YouTube!");const i="https://api.openai.com/v1/chat/completions";let o=null,m=null,k=null;async function $(){return k||(k=(await chrome.storage.sync.get(["openaiApiKey"])).openaiApiKey,k)}async function Z(l){k=l,await chrome.storage.sync.set({openaiApiKey:l})}function P(){return new URLSearchParams(window.location.search).get("v")}function j(l){if(!l)return 0;const c=l.split(":").map(Number);return c.length===2?c[0]*60+c[1]:c.length===3?c[0]*3600+c[1]*60+c[2]:0}function F(l){const c=Math.floor(l/3600),g=Math.floor(l%3600/60),h=Math.floor(l%60);return c>0?`${c}:${g.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`:`${g}:${h.toString().padStart(2,"0")}`}async function J(){var l,c,g;try{const h=document.querySelector('button[aria-label*="transcript" i], button[aria-label*="Transcript" i]');if(!h)return null;h.click(),await new Promise(e=>setTimeout(e,2e3));const T=document.querySelectorAll("ytd-transcript-segment-renderer");if(T.length===0)return(l=document.querySelector('button[aria-label*="Close transcript" i]'))==null||l.click(),null;const E=Array.from(T).map(e=>{var y,s;const r=e.querySelector('[class*="timestamp"], .cue-group-start-offset'),a=e.querySelector('[class*="text"], .cue, yt-formatted-string'),p=((y=r==null?void 0:r.textContent)==null?void 0:y.trim())||"",x=((s=a==null?void 0:a.textContent)==null?void 0:s.trim())||"";return{time:p,text:x,seconds:j(p)}}).filter(e=>e.text);(c=document.querySelector('button[aria-label*="Close transcript" i]'))==null||c.click();const w=[];let v={startSeconds:0,endSeconds:0,texts:[]};E.forEach((e,r)=>{v.texts.length===0&&(v.startSeconds=e.seconds),v.texts.push(e.text),v.endSeconds=e.seconds,(v.endSeconds-v.startSeconds>=30||r===E.length-1)&&(w.push({...v}),v={startSeconds:e.seconds,endSeconds:e.seconds,texts:[]})});const t=E.map(e=>e.text).join(" ");return{chunks:w,fullTranscript:t}}catch{return(g=document.querySelector('button[aria-label*="Close transcript" i]'))==null||g.click(),null}}function Y(l){const c=document.querySelector("video");c&&(c.currentTime=l,c.play())}async function R(l,c){var h,T,E;if(m&&m.video_id===l)return m;const g=await $();if(!g)return{error:"Please set your OpenAI API key first.",title:"",summary:"",video_id:""};try{const w=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"system",content:"You are a helpful assistant that summarizes YouTube video transcripts. Provide a concise but comprehensive summary of the video content, highlighting the main points and key takeaways."},{role:"user",content:`Please summarize this YouTube video transcript:

${c}`}],max_tokens:500,temperature:.7})});if(!w.ok){const r=await w.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(((h=r.error)==null?void 0:h.message)||`HTTP ${w.status}`)}const e={title:"Video Summary",summary:((E=(T=(await w.json()).choices[0])==null?void 0:T.message)==null?void 0:E.content)||"No summary generated",video_id:l};return m=e,e}catch(w){return console.error("OpenAI API error:",w),{error:`Failed to generate summary: ${w.message}`,title:"",summary:"",video_id:""}}}function H(l){var I;(I=document.getElementById("summatube-panel"))==null||I.remove();const c=document.getElementById("secondary")||document.querySelector("#related");if(!c)return;o=P();const g=document.createElement("div");g.id="summatube-panel";const h=document.documentElement.hasAttribute("dark")||document.body.classList.contains("ytd-watch-flexy--dark-theme");g.classList.add(h?"dark":"light");let T="";l?l==="loading"?T=`
          <div class="status-text">
            <div class="emoji">‚è≥</div>
            <div>Loading transcript...</div>
          </div>`:T=l.chunks.map(u=>{const C=F(u.startSeconds),B=F(u.endSeconds),be=u.texts.join(" ");return`
            <div class="chunk">
              <div class="timestamp summatube-seek" data-seconds="${u.startSeconds}">
                [${C} ‚Äì ${B}]
              </div>
              <div>${be}</div>
            </div>`}).join(""):T=`
          <div class="status-text">
            <div class="emoji">üìú</div>
            <div>No transcript available.</div>
          </div>`;const E=l&&l!=="loading"&&l.fullTranscript;let w="";E&&(w=`
          <div class="summary-section">
            <div id="summatube-api-key-section" class="api-key-section" style="display:none;">
              <div class="api-key-input-group">
                <input type="password" id="summatube-api-key-input" class="api-key-input"
                       placeholder="Enter your OpenAI API key">
                <button id="summatube-save-api-key-btn" class="save-api-key-btn">Save Key</button>
              </div>
              <div class="api-key-help">
                Get your API key from <a href="https://platform.openai.com/api-keys" target="_blank" class="api-link">OpenAI Platform</a>
              </div>
            </div>
            <div id="summatube-summary-controls">
              <button id="summatube-summary-btn" class="summary-btn">
                ‚ú® Generate AI Summary
              </button>
              <button id="summatube-api-key-btn" class="api-key-btn">üîë Set API Key</button>
            </div>
            <div id="summatube-summary-result" class="summary-result" style="display:none;"></div>
          </div>
        `),g.innerHTML=`
        <div class="summatube-header ${h?"dark":"light"}">
          <div>
            <div class="header-title">SummaTube</div>
            <div class="header-subtitle">Transcript + AI Summary</div>
          </div>
          <button id="summatube-toggle-btn">‚àí</button>
        </div>
        <div class="summatube-content ${h?"dark":"light"}">
          ${T}
          ${w}
        </div>
      `;const v=g.querySelector("#summatube-toggle-btn"),t=g.querySelector(".summatube-content"),e=g.querySelector(".summatube-header");function r(){g.classList.toggle("minimized"),v.textContent=g.classList.contains("minimized")?"+":"‚àí",g.classList.contains("minimized")||(t.scrollTop=0)}v.addEventListener("click",u=>{u.stopPropagation(),r()}),e.addEventListener("click",r),g.querySelectorAll(".summatube-seek").forEach(u=>{u.addEventListener("click",()=>Y(parseInt(u.dataset.seconds,10)))});const a=g.querySelector("#summatube-summary-btn"),p=g.querySelector("#summatube-summary-result");a&&E&&a.addEventListener("click",async()=>{a.disabled=!0,a.innerHTML="‚è≥ Generating...";const u=await R(o,l.fullTranscript);u.error?p.innerHTML=`<div class="error-text">‚ö†Ô∏è ${u.error}</div>`:p.innerHTML=`
              <div class="summary-card">
                <div class="summary-title">‚ú® AI Summary</div>
                <div class="summary-body">${u.summary}</div>
                <div class="summary-footer">
                  Powered by OpenAI GPT-3.5
                </div>
              </div>
            `,p.style.display="block",a.style.display="none"});const x=g.querySelector("#summatube-api-key-btn"),y=g.querySelector("#summatube-api-key-section"),s=g.querySelector("#summatube-api-key-input"),S=g.querySelector("#summatube-save-api-key-btn"),f=g.querySelector("#summatube-summary-controls");x&&y&&f&&($().then(u=>{u?x.style.display="none":x.style.display="inline-block"}),x.addEventListener("click",()=>{y.style.display="block",f.style.display="none",s.focus()}),S.addEventListener("click",async()=>{const u=s.value.trim();u&&(await Z(u),y.style.display="none",f.style.display="block",x.style.display="none",s.value="")}),s.addEventListener("keypress",u=>{u.key==="Enter"&&S.click()})),c.insertBefore(g,c.firstChild)}async function O(){if(!P())return;H("loading");const c=await J();H(c||null)}const M=new MutationObserver(()=>{(document.getElementById("secondary")||document.querySelector("#related"))&&(M.disconnect(),setTimeout(O,1200))});M.observe(document.body,{childList:!0,subtree:!0}),(document.getElementById("secondary")||document.querySelector("#related"))&&setTimeout(O,1200)}};var D=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function le(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var te={exports:{}};(function(n,i){(function(o,m){m(n)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:D,function(o){var m,k;if(!((k=(m=globalThis.chrome)==null?void 0:m.runtime)!=null&&k.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const $="The message port closed before a response was received.",Z=P=>{const j={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(j).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class F extends WeakMap{constructor(e,r=void 0){super(r),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const J=t=>t&&typeof t=="object"&&typeof t.then=="function",Y=(t,e)=>(...r)=>{P.runtime.lastError?t.reject(new Error(P.runtime.lastError.message)):e.singleCallbackArg||r.length<=1&&e.singleCallbackArg!==!1?t.resolve(r[0]):t.resolve(r)},R=t=>t==1?"argument":"arguments",H=(t,e)=>function(a,...p){if(p.length<e.minArgs)throw new Error(`Expected at least ${e.minArgs} ${R(e.minArgs)} for ${t}(), got ${p.length}`);if(p.length>e.maxArgs)throw new Error(`Expected at most ${e.maxArgs} ${R(e.maxArgs)} for ${t}(), got ${p.length}`);return new Promise((x,y)=>{if(e.fallbackToNoCallback)try{a[t](...p,Y({resolve:x,reject:y},e))}catch(s){console.warn(`${t} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,s),a[t](...p),e.fallbackToNoCallback=!1,e.noCallback=!0,x()}else e.noCallback?(a[t](...p),x()):a[t](...p,Y({resolve:x,reject:y},e))})},O=(t,e,r)=>new Proxy(e,{apply(a,p,x){return r.call(p,t,...x)}});let M=Function.call.bind(Object.prototype.hasOwnProperty);const l=(t,e={},r={})=>{let a=Object.create(null),p={has(y,s){return s in t||s in a},get(y,s,S){if(s in a)return a[s];if(!(s in t))return;let f=t[s];if(typeof f=="function")if(typeof e[s]=="function")f=O(t,t[s],e[s]);else if(M(r,s)){let I=H(s,r[s]);f=O(t,t[s],I)}else f=f.bind(t);else if(typeof f=="object"&&f!==null&&(M(e,s)||M(r,s)))f=l(f,e[s],r[s]);else if(M(r,"*"))f=l(f,e[s],r["*"]);else return Object.defineProperty(a,s,{configurable:!0,enumerable:!0,get(){return t[s]},set(I){t[s]=I}}),f;return a[s]=f,f},set(y,s,S,f){return s in a?a[s]=S:t[s]=S,!0},defineProperty(y,s,S){return Reflect.defineProperty(a,s,S)},deleteProperty(y,s){return Reflect.deleteProperty(a,s)}},x=Object.create(t);return new Proxy(x,p)},c=t=>({addListener(e,r,...a){e.addListener(t.get(r),...a)},hasListener(e,r){return e.hasListener(t.get(r))},removeListener(e,r){e.removeListener(t.get(r))}}),g=new F(t=>typeof t!="function"?t:function(r){const a=l(r,{},{getContent:{minArgs:0,maxArgs:0}});t(a)}),h=new F(t=>typeof t!="function"?t:function(r,a,p){let x=!1,y,s=new Promise(u=>{y=function(C){x=!0,u(C)}}),S;try{S=t(r,a,y)}catch(u){S=Promise.reject(u)}const f=S!==!0&&J(S);if(S!==!0&&!f&&!x)return!1;const I=u=>{u.then(C=>{p(C)},C=>{let B;C&&(C instanceof Error||typeof C.message=="string")?B=C.message:B="An unexpected error occurred",p({__mozWebExtensionPolyfillReject__:!0,message:B})}).catch(C=>{console.error("Failed to send onMessage rejected reply",C)})};return I(f?S:s),!0}),T=({reject:t,resolve:e},r)=>{P.runtime.lastError?P.runtime.lastError.message===$?e():t(new Error(P.runtime.lastError.message)):r&&r.__mozWebExtensionPolyfillReject__?t(new Error(r.message)):e(r)},E=(t,e,r,...a)=>{if(a.length<e.minArgs)throw new Error(`Expected at least ${e.minArgs} ${R(e.minArgs)} for ${t}(), got ${a.length}`);if(a.length>e.maxArgs)throw new Error(`Expected at most ${e.maxArgs} ${R(e.maxArgs)} for ${t}(), got ${a.length}`);return new Promise((p,x)=>{const y=T.bind(null,{resolve:p,reject:x});a.push(y),r.sendMessage(...a)})},w={devtools:{network:{onRequestFinished:c(g)}},runtime:{onMessage:c(h),onMessageExternal:c(h),sendMessage:E.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:E.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},v={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return j.privacy={network:{"*":v},services:{"*":v},websites:{"*":v}},l(P,w,j)};o.exports=Z(chrome)}else o.exports=globalThis.browser})})(te);var me=te.exports,re=le(me);const ce={};function W(n,...i){}var ge={debug:(...n)=>W(console.debug,...n),log:(...n)=>W(console.log,...n),warn:(...n)=>W(console.warn,...n),error:(...n)=>W(console.error,...n)},ue=(_=class extends Event{constructor(i,o){super(_.EVENT_NAME,{}),this.newUrl=i,this.oldUrl=o}},Q(_,"EVENT_NAME",se("wxt:locationchange")),_);function se(n){const i=typeof ce>"u"?"build":"content";return`${re.runtime.id}:${i}:${n}`}function de(n){let i,o;return{run(){i==null&&(o=new URL(location.href),i=n.setInterval(()=>{let m=new URL(location.href);m.href!==o.href&&(window.dispatchEvent(new ue(m,o)),o=m)},1e3))}}}var Ae=(L=class{constructor(i,o){U(this,N);U(this,V,window.self===window.top);U(this,q);U(this,G,de(this));this.contentScriptName=i,this.options=o,ae(this,q,new AbortController),z(this,V)&&ee(this,N,ie).call(this),this.setTimeout(()=>{ee(this,N,oe).call(this)})}get signal(){return z(this,q).signal}abort(i){return z(this,q).abort(i)}get isInvalid(){return re.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(i){return this.signal.addEventListener("abort",i),()=>this.signal.removeEventListener("abort",i)}block(){return new Promise(()=>{})}setInterval(i,o){const m=setInterval(()=>{this.isValid&&i()},o);return this.onInvalidated(()=>clearInterval(m)),m}setTimeout(i,o){const m=setTimeout(()=>{this.isValid&&i()},o);return this.onInvalidated(()=>clearTimeout(m)),m}requestAnimationFrame(i){const o=requestAnimationFrame((...m)=>{this.isValid&&i(...m)});return this.onInvalidated(()=>cancelAnimationFrame(o)),o}requestIdleCallback(i,o){const m=requestIdleCallback((...k)=>{this.signal.aborted||i(...k)},o);return this.onInvalidated(()=>cancelIdleCallback(m)),m}addEventListener(i,o,m,k){var $;o==="wxt:locationchange"&&this.isValid&&z(this,G).run(),($=i.addEventListener)==null||$.call(i,o.startsWith("wxt:")?se(o):o,m,{...k,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),ge.debug(`Content script "${this.contentScriptName}" context invalidated`)}},V=new WeakMap,q=new WeakMap,G=new WeakMap,N=new WeakSet,ie=function(){window.postMessage({type:L.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName},"*")},oe=function(){const i=o=>{var m,k;((m=o.data)==null?void 0:m.type)===L.SCRIPT_STARTED_MESSAGE_TYPE&&((k=o.data)==null?void 0:k.contentScriptName)===this.contentScriptName&&this.notifyInvalidated()};addEventListener("message",i),this.onInvalidated(()=>removeEventListener("message",i))},Q(L,"SCRIPT_STARTED_MESSAGE_TYPE","wxt:content-script-started"),L);function ke(){}function K(n,...i){}var pe={debug:(...n)=>K(console.debug,...n),log:(...n)=>K(console.log,...n),warn:(...n)=>K(console.warn,...n),error:(...n)=>K(console.error,...n)},fe=(async()=>{try{const{main:n,...i}=b,o=new Ae("content",i);return await n(o)}catch(n){throw pe.error('The content script "content" crashed on startup!',n),n}})(),xe=fe;return xe}();
_content;
